<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search...</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.3.0/papaparse.min.js"></script>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 8px;
        }
    </style>
</head>
<body>

    <h1>Search Data</h1>

    <!-- Search input field -->
    <input type="text" id="search-input" placeholder="Search...">

    <br><br>

    <!-- Table to display data -->
    <table id="excel-table">
        <thead>
            <tr id="table-header"></tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>

    <script>
        const googleSheetUrl = "https://docs.google.com/spreadsheets/d/1CIXqlAczg5xh0eB0D7Itje9fWXG-y0ZtVFVA-lBoWDE/export?format=csv"; // Replace with your sheet's CSV link
         let sheetData = [];
        let headers = [];

        // Fetch CSV from Google Sheets
        fetch(googleSheetUrl)
            .then(response => response.text())
            .then(csv => {
                parseCSV(csv);
            })
            .catch(error => console.error('Error fetching the Google Sheet:', error));

        // Function to parse CSV data manually
        function parseCSV(csv) {
            // Split the CSV data into rows
            const rows = csv.split("\n");
            
            // Get the headers (first row)
            headers = rows[0].split(","); // Split by commas for each column
            
            // Process remaining rows as data
            sheetData = rows.slice(1).map(row => row.split(","));

            renderTable();
        }

        // Function to render the table with data
        function renderTable() {
            // Clear the table
            const headerRow = document.getElementById('table-header');
            const bodyRow = document.getElementById('table-body');

            // Add headers to the table
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });

            // Add data to the table
            sheetData.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                bodyRow.appendChild(tr);
            });
        }

        // Filter the table based on search input
        document.getElementById('search-input').addEventListener('input', function() {
            const searchText = this.value.toLowerCase();
            const filteredData = sheetData.filter(row => {
                return row.some(cell => cell.toString().toLowerCase().includes(searchText));
            });
            renderFilteredTable(filteredData);
        });

        function renderFilteredTable(filteredData) {
            // Clear the table body
            const bodyRow = document.getElementById('table-body');
            bodyRow.innerHTML = '';

            // Add filtered data to the table
            filteredData.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                bodyRow.appendChild(tr);
            });
        }
    </script>

</body>
</html>
